import"./request-CT5bBdcx.js";/* empty css                   *//* empty css                     *//* empty css                     */import{e as A,a as O,p as X,b as Z,f as G,h as J}from"./exam-CFzY93NG.js";import{_ as K,b as W}from"./question-QwdAkLjT.js";import{a1 as V,e as D,r as y,c as r,a as s,t as ee,u as q,b as a,w as i,d as w,Q as p,E as te,$ as ae,T as le,X as oe,a2 as se,o as c,i as m,Z as ie,n as f,_ as ne,S as de,U as ue,Y as me}from"./index-4IXDAXJx.js";import{_ as re}from"./_plugin-vue_export-helper-DlAUqK2U.js";const pe={class:"add-exam-component-box"},ce={class:"add-exam-component"},fe={class:"exam-base-info-box"},xe={class:"exam-base-title"},_e={class:"base-title"},ve={class:"exam-base-info"},ye={class:"group-box"},ge={class:"group-item"},be={class:"group-box"},De={class:"group-item"},Ee={class:"group-box"},Ie={class:"group-item"},ke={class:"exam-select-question-box"},Ce={key:0,style:{color:"#3EC8FF"}},Se={key:1,style:{color:"#FE7909"}},Ve={key:2,style:{color:"#FD4C40"}},qe={class:"exam-list-box"},we={key:0,style:{color:"#3EC8FF"}},he={key:1,style:{color:"#FE7909"}},ze={key:2,style:{color:"#FD4C40"}},Fe={class:"exam-question-list-button"},Qe={class:"submit-box absolute"},Ne={__name:"UpdateExam",setup(Te){const h=V().query.type,t=D({examId:"",title:"",examDate:""}),n=D({pageNum:1,pageSize:10,difficulty:"",title:""});function E(){w.go(-1)}async function z(){if(t.title==null||t.title=="")p.error("请输入标题");else if(t.examDate==null||t.examDate==""||t.examDate[0]==""||t.examDate[0]==null||t.examDate[1]==""||t.examDate[1]==null)p.error("请选择竞赛时间");else{const l=new FormData;for(let e in t)e==="examDate"?(l.append("startTime",t.examDate[0]),l.append("endTime",t.examDate[1])):e!=="startTime"&&e!=="endTime"&&l.append(e,t[e]);if(t.examId)await A(l);else{const e=await O(l);t.examId=e.data}p.success("基本信息保存成功")}}const I=y([]),k=y(0);async function x(){const l=await W(n);console.log(l),I.value=l.rows,k.value=l.total}const v=y(!1);function F(){t.examId===null||t.examId===""?p.error("请先保存竞赛基本信息"):(x(),v.value=!0)}function Q(){n.pageNum=1,x()}function N(){x()}function T(){n.pageNum=1,x()}function U(){n.pageNum=1,n.pageSize=10,n.title="",n.difficulty="",x()}async function B(){await X(t.examId),w.push("/oj/system/exam")}const _=y([]);function L(l){_.value=[],l.forEach(e=>{_.value.push(e.questionId)})}async function Y(){if(_.value&&_.value.length<1)return p.error("请先选择要提交的题目"),!1;const l=D({examId:t.examId,questionIdSet:_.value});console.log(l),await G(l),g(t.examId),v.value=!1,p.success("竞赛题目添加成功")}async function R(){const l=V().query.examId;l&&(t.examId=l,g(l))}R();async function $(l,e){await J(l,e),g(l),p.success("竞赛题目删除成功")}async function g(l){const e=await Z(l);t.examQuestionList=[],Object.assign(t,e.data),t.examDate=[e.data.startTime,e.data.endTime]}return(l,e)=>{const C=te,j=ae,d=le,u=ne,S=oe,b=de,M=ue,P=me,H=se;return c(),r("div",pe,[s("div",ce,[s("div",fe,[s("div",xe,[s("span",_e,ee(q(h)==="edit"?"编辑竞赛":"添加竞赛"),1),s("span",{class:"go-back",onClick:E},"返回")]),s("div",ve,[s("div",ye,[s("div",ge,[e[8]||(e[8]=s("div",{class:"item-label required"},"竞赛名称",-1)),s("div",null,[a(C,{modelValue:t.title,"onUpdate:modelValue":e[0]||(e[0]=o=>t.title=o),style:{width:"420px"},placeholder:"请填写竞赛名称"},null,8,["modelValue"])])])]),s("div",be,[s("div",De,[e[9]||(e[9]=s("div",{class:"item-label required"},"竞赛周期",-1)),s("div",null,[a(j,{modelValue:t.examDate,"onUpdate:modelValue":e[1]||(e[1]=o=>t.examDate=o),disabledDate:l.disabledDate,type:"datetimerange","start-placeholder":"竞赛开始时间","end-placeholder":"竞赛结束时间","value-format":"YYYY-MM-DD HH:mm:ss"},null,8,["modelValue","disabledDate"])])])]),s("div",Ee,[s("div",Ie,[a(d,{class:"exam-base-info-button",type:"primary",plain:"",onClick:z},{default:i(()=>e[10]||(e[10]=[m("保存")])),_:1})])])])]),s("div",ke,[a(d,{class:"exam-add-question",icon:q(ie),type:"text",onClick:e[2]||(e[2]=o=>F())},{default:i(()=>e[11]||(e[11]=[m(" 添加题目 ")])),_:1},8,["icon"]),a(S,{height:"300px",data:t.examQuestionList,class:"question-select-list"},{default:i(()=>[a(u,{prop:"questionId",width:"180px",label:"题目ID"}),a(u,{prop:"title","show-overflow-tooltip":!0,label:"题目标题"}),a(u,{prop:"difficulty",width:"80px",label:"题目难度"},{default:i(({row:o})=>[o.difficulty===1?(c(),r("div",Ce,"简单")):f("",!0),o.difficulty===2?(c(),r("div",Se,"中等")):f("",!0),o.difficulty===3?(c(),r("div",Ve,"困难")):f("",!0)]),_:1}),a(u,{label:"操作",width:"80px"},{default:i(({row:o})=>[a(d,{circle:"",type:"text",onClick:Ue=>$(t.examId,o.questionId)},{default:i(()=>e[12]||(e[12]=[m(" 删除 ")])),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])]),s("div",null,[a(H,{modelValue:v.value,"onUpdate:modelValue":e[7]||(e[7]=o=>v.value=o)},{default:i(()=>[s("div",qe,[e[16]||(e[16]=s("div",{class:"exam-list-title required"},"选择竞赛题目",-1)),a(M,{inline:"true"},{default:i(()=>[a(b,{label:"题目难度"},{default:i(()=>[a(K,{modelValue:n.difficulty,"onUpdate:modelValue":e[3]||(e[3]=o=>n.difficulty=o),style:{width:"120px"}},null,8,["modelValue"])]),_:1}),a(b,{label:"题目名称"},{default:i(()=>[a(C,{modelValue:n.title,"onUpdate:modelValue":e[4]||(e[4]=o=>n.title=o),placeholder:"请输入题目标题"},null,8,["modelValue"])]),_:1}),a(b,null,{default:i(()=>[a(d,{onClick:T,plain:""},{default:i(()=>e[13]||(e[13]=[m("搜索")])),_:1}),a(d,{onClick:U,plain:"",type:"info"},{default:i(()=>e[14]||(e[14]=[m("重置")])),_:1})]),_:1})]),_:1}),a(S,{data:I.value,onSelect:L},{default:i(()=>[a(u,{type:"selection"}),a(u,{prop:"questionId",label:"题目ID"}),a(u,{prop:"title",label:"题目标题"}),a(u,{prop:"difficulty",label:"题目难度"},{default:i(({row:o})=>[o.difficulty===1?(c(),r("div",we,"简单")):f("",!0),o.difficulty===2?(c(),r("div",he,"中等")):f("",!0),o.difficulty===3?(c(),r("div",ze,"困难")):f("",!0)]),_:1})]),_:1},8,["data"]),s("div",Fe,[a(P,{background:"",size:"small",layout:"total, sizes, prev, pager, next, jumper",total:k.value,"current-page":n.pageNum,"onUpdate:currentPage":e[5]||(e[5]=o=>n.pageNum=o),"page-size":n.pageSize,"onUpdate:pageSize":e[6]||(e[6]=o=>n.pageSize=o),"page-sizes":[5,10,30,50],onSizeChange:Q,onCurrentChange:N},null,8,["total","current-page","page-size"]),a(d,{class:"question-select-submit",type:"primary",plain:"",onClick:Y},{default:i(()=>e[15]||(e[15]=[m("提交")])),_:1})])])]),_:1},8,["modelValue"])]),s("div",Qe,[a(d,{type:"info",plain:"",onClick:E},{default:i(()=>e[17]||(e[17]=[m("暂不发布")])),_:1}),a(d,{type:"primary",plain:"",onClick:B},{default:i(()=>e[18]||(e[18]=[m("发布竞赛")])),_:1})])])])}}},He=re(Ne,[["__scopeId","data-v-b959c6ae"]]);export{He as default};
